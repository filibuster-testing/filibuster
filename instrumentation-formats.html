<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data Types &mdash; filibuster  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> filibuster
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">filibuster</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Data Types</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/instrumentation-formats.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="data-types">
<h1>Data Types<a class="headerlink" href="#data-types" title="Permalink to this headline"></a></h1>
<p>All instrumentation calls should contain JSON payloads and return JSON bodies in the response.  Certain fields require particular data formats, these are described in this section; all other data formats are discussed in the sections for each API request that requires it.</p>
<p>For reference, we include an example request body for the <code class="docutils literal notranslate"><span class="pre">PUT</span> <span class="pre">/filibuster/create</span></code> call for the <code class="docutils literal notranslate"><span class="pre">cinema-1</span></code> example.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;instrumentation_type&quot;</span><span class="p">:</span> <span class="s2">&quot;invocation&quot;</span><span class="p">,</span>
  <span class="nt">&quot;source_service_name&quot;</span><span class="p">:</span> <span class="s2">&quot;users&quot;</span><span class="p">,</span>
  <span class="nt">&quot;module&quot;</span><span class="p">:</span> <span class="s2">&quot;requests&quot;</span><span class="p">,</span>
  <span class="nt">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;get&quot;</span><span class="p">,</span>
  <span class="nt">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;http://0.0.0.0:5001/movies/267eedb8-0f5d-42d5-8f43-72426b9fb3e6&quot;</span>
  <span class="p">],</span>
  <span class="nt">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{},</span>
  <span class="nt">&quot;callsite_file&quot;</span><span class="p">:</span> <span class="s2">&quot;/Users/c.meiklejohn/Documents/GitHub/nufilibuster/examples/cinema-1/services/users/users/app.py&quot;</span><span class="p">,</span>
  <span class="nt">&quot;callsite_line&quot;</span><span class="p">:</span> <span class="s2">&quot;113&quot;</span><span class="p">,</span>
  <span class="nt">&quot;full_traceback&quot;</span><span class="p">:</span> <span class="s2">&quot;436928f8a571d50077e6c6972034959a&quot;</span><span class="p">,</span>
  <span class="nt">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;timeout&quot;</span><span class="p">:</span> <span class="mi">10</span>
  <span class="p">},</span>
  <span class="nt">&quot;vclock&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;users&quot;</span><span class="p">:</span> <span class="mi">2</span>
  <span class="p">},</span>
  <span class="nt">&quot;origin_vclock&quot;</span><span class="p">:</span> <span class="p">{},</span>
  <span class="nt">&quot;execution_index&quot;</span><span class="p">:</span> <span class="s2">&quot;[[\&quot;68ae4deac392aa61feeeb0634d243d57\&quot;, 1]]&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="instrumentation-type">
<h2>Instrumentation Type<a class="headerlink" href="#instrumentation-type" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">instrumentation_type</span></code> field in an instrumentation call is an enumeration, provided as a string.  The valid values are provided in the table below.  Each of these options is described in detail in the following sections where the API is described.</p>
<table class="colwidths-auto force-left docutils align-left" id="id1">
<caption><span class="caption-text">Enumeration for the <code class="docutils literal notranslate"><span class="pre">instrumentation_type</span></code> field in either a request payload or response body.</span><a class="headerlink" href="#id1" title="Permalink to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">invocation</span></code></p></td>
<td><p>Instrumentation call from a call site where a request to another service is made.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">request_received</span></code></p></td>
<td><p>Instrumentation call from a call site where the request of a remote call is received.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">invocation_complete</span></code></p></td>
<td><p>Instrumentation call from a call site where a request to another service has completed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="vector-clocks">
<h2>Vector Clocks<a class="headerlink" href="#vector-clocks" title="Permalink to this headline"></a></h2>
<p>Vector clocks (and origin vector clocks) should be provided as a JSON object.  This JSON object should be structured with a single key for each service and it’s value the associated counter for each action.</p>
<p>We provide an example:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;users&quot;</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here, the clock shows that the users service has performed two remote requests.  Similarly, a if the users service has performed two remote requests and the bookings service had also performed a request, the clock would look like the following:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;users&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="nt">&quot;bookings&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We refer the reader to our implementation of vector clocks in Python to understand implementation and the algorithm: this is outside of the scope of this documentation.</p>
</section>
<section id="execution-index">
<h2>Execution Index<a class="headerlink" href="#execution-index" title="Permalink to this headline"></a></h2>
<p>Execution indexes should be encoded as a string that is JSON-parseable into an array.  In our example, the following execution index:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;[[\&quot;68ae4deac392aa61feeeb0634d243d57\&quot;, 1]]&quot;</span>
</pre></div>
</div>
<p>would reflect the following execution index, a list containing a single pair:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="s2">&quot;68ae4deac392aa61feeeb0634d243d57&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
<p>Executions indexes are made up of pairs of unique identifiers for a callsite and a count of how many times that call site was hit before issuing the request.  The unique identifier for a callsite need only be a string: any unique hash generated by the service is sufficient and no special encoding is used, as it is specific to that service.  As execution indexes are transmitted between machines, these must be serializable and deserializable as strings by all services in the application.</p>
<p>Compared to vector clocks – where the Filibuster test server needs to actually perform clock comparisons for dynamic reduction – execution indexes are only used for direct equality checks and therefore the string representation is used instead of a nested JSON object in the instrumentation call.</p>
<p>We refer the reader to our implementation of execution indexes in Python to understand implementation and the algorithm: this is outside of the scope of this documentation.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Christopher S. Meiklejohn.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>